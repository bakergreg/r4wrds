---
title: "Spreadsheets & Pivoting"
description: | 
  Tidy data and best practices for spreadsheets!
output: 
  distill::distill_article:
    toc: true
---

```{r setup, include=FALSE, purl=FALSE, message=FALSE}

library(knitr)
library(here)
suppressPackageStartupMessages(library(tidyverse))

```

:::obj

**Learning objectives**
 
 - Understand what messy data is and how to avoid it
 - Understand how to use spreadsheets effectively
 - Learn to pivot your data to wide to long

:::

## Spreadsheets

Spreadsheets have been woven into nearly every facet and field, and while they are meant to make our lives easier, it is more typical that we spend untangling the data adventures they create. 

However, a few simple tips about how to structure and use spreadsheets can make all the difference. While learning how to more effectively use spreadsheets *will* make life easier and more reproducible, there will always still be a messy dataset that comes your way.

Let's go over what tidy data should look like, and then take a look at a messy real-life spreadsheet, and figure out what could be done to make it tidy!

## What is Tidy Data?

Typically when we look at data, we should always want it to be in a "tidy" format. To be in a tidy format, we want to have each **column** as a unique variable, and each **row** as a unique observation of data. 

(ref:tidyData1) *Illustrations from the Openscapes blog Tidy Data for reproducibility, efficiency, and collaboration by Julia Lowndes and Allison Horst*

```{r tidydata, echo=FALSE, fig.cap="(ref:tidyData1)"}
include_graphics(here::here("images", "tidydata_1.jpg"))
```


### Dealing with Messy Data

Messy data has many forms and it exists *everywhere*. Much of data science hinges on cleaning up and reformatting data so it can be used in some way other than the form it exists in.

(ref:tidyData2) *Illustrations from the Openscapes blog Tidy Data for reproducibility, efficiency, and collaboration by Julia Lowndes and Allison Horst*

```{r tidydata2, echo=FALSE, fig.cap="(ref:tidyData2)"}
include_graphics(here::here("images", "tidydata_2.jpg"))
```

### Same Tools, Different Data

The great news is we can use a similar set of tools to deal with tidying and cleaning our data, and once we've learned these tools, there are few datasets that will stand in your way (though some may take longer than others!). An important thing to learn is that ***tidy data starts the moment we begin recording information***. The more we can collect and update data in a "*tidy*" fashion, the less cleaning and wrangling is required to work with that data.

(ref:tidyData3) *Illustrations from the Openscapes blog Tidy Data for reproducibility, efficiency, and collaboration by Julia Lowndes and Allison Horst*

```{r tidydata3, echo=FALSE, fig.cap="(ref:tidyData3)"}
include_graphics(here::here("images", "tidydata_3.jpg"))
```

## Understanding Messy Spreadsheets

An important step towards tidy data is learning to quickly spot where data is *messy* and what needs to be fixed.

Let's take a look at this [**messy** spreadsheet data](downloadlinkhere) which is based on data from the [Calenviroscreen data](https://oehha.ca.gov/calenviroscreen) from previous modules. 

<br>

```{r messytab, echo=FALSE, out.width='100%'}

include_graphics(here::here("images", "messy_spreadsheet_2.png"))

```

 
 <br>

:::challenge

**CHALLENGE 1**  

 - **What issues do you notice about this spreadsheet?**
 - **What could we do to make this tidy?**

:::

<br>

<details>
  <summary class="challenge-ans-title">**Click for Answers!**</summary>
  <div class="challenge-ans-body">
 - Multiple tables on one sheet
 - Tables start on different rows
 - Different date formats
 - Different county spellings (see `California County`)
 - Color encoding
  </div>
</details> 

<br>

<details><summary class="extra-practice-title">Extra Practice</summary>
  <div class="extra-practice-body">
*If you are interested in an excellent lesson on how to improve your spreadsheet skills, checkout the excellent lesson via [Data Carpentry: Data Organization in Spreadsheets for Ecologists](https://datacarpentry.org/spreadsheet-ecology-lesson/). This lesson should be read by anyone and everyone who uses spreadsheets (which is everyone), so go take a look!*
  </div>
</details

<br>

## Important Rules for Working with Spreadsheets

If you have to work with a multi-tabbed spreadsheet (which we all do at some point), there are some basic rules/tips that can save you and anyone else that needs to work with the same spreadsheet.

 - have a README tab to record the general "what you did" 
 - Where possible keep dates in YYYY-MM-DD or better yet, split date into a different column (i.e, Year, Month, Day, Hours, Minutes). We can easily stitch these together in R^[lubridate].
 - Keep one table per tab and don't mix figures with tables!
 - Keep column names clean and include units
 - Don't use colors even though it's fun! You can see that as data while the computer can't.
